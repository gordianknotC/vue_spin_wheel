(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12327384"],{"1cdc":function(e,t,r){},"44e3":function(e,t,r){},b218:function(e,t,r){"use strict";r("44e3")},eebe:function(e,t,r){"use strict";r("1cdc")},fef8:function(e,t,r){"use strict";r.r(t);var n=r("7a23");const o=e=>(Object(n["pushScopeId"])("data-v-61d498d5"),e=e(),Object(n["popScopeId"])(),e),a={class:"p-4"},c=o(()=>Object(n["createElementVNode"])("h3",{class:"text-2xl my-2"},"SpinWheel Demo",-1)),i={class:"py-6 flex justify-center overflow-hidden"},l={class:"wheel mb-4"},s={class:"wheel__content",ref:"wheelElt"},d=o(()=>Object(n["createElementVNode"])("div",{class:"wheel__innerShadow"},null,-1)),u=o(()=>Object(n["createElementVNode"])("hr",{class:"my-4"},null,-1)),b=o(()=>Object(n["createElementVNode"])("h3",{class:"text-2xl my-2"},"Sector Demo",-1));function g(e,t,r,o,g,m){const f=Object(n["resolveComponent"])("svg-icon"),p=Object(n["resolveComponent"])("Sector"),h=Object(n["resolveComponent"])("van-button");return Object(n["openBlock"])(),Object(n["createElementBlock"])("section",a,[c,Object(n["createElementVNode"])("div",i,[Object(n["createElementVNode"])("div",l,[Object(n["createVNode"])(f,{class:"wheel__pointer",name:"wheel-pointer",size:60}),Object(n["createVNode"])(f,{class:"wheel__border",name:"wheel-border",size:327}),Object(n["createElementVNode"])("div",s,[d,(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.wheelList,(t,r)=>(Object(n["openBlock"])(),Object(n["createBlock"])(p,{class:"wheel__sector",style:Object(n["normalizeStyle"])(e.getSectorStyle(r)),key:r,text:t.worth,"background-color":e.getColor(t,r),"border-thickness":0,diameter:280,sectorAngleInDegree:e.sectorAngle,initialQuadrant:4,fontColor:e.getFontColor(t),fontSize:"1.5rem"},null,8,["style","text","background-color","sectorAngleInDegree","fontColor"]))),128))],512)])]),Object(n["createVNode"])(h,{type:"primary",onClick:e.spin,block:"",disabled:e.stage==e.EStage.spinning},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("Spin")]),_:1},8,["onClick","disabled"]),u,b,Object(n["createVNode"])(p,{text:"45'-4 quadrant","background-color":"blue","border-thickness":0,sectorAngleInDegree:45,initialQuadrant:4,diameter:280,"font-color":"black"}),Object(n["createVNode"])(p,{text:"60'-4 quadrant","background-color":"orange","border-thickness":0,sectorAngleInDegree:60,initialQuadrant:4,diameter:280}),Object(n["createVNode"])(p,{text:"45'-1 quadrant","background-color":"blue","border-thickness":0,sectorAngleInDegree:45,initialQuadrant:1,diameter:280}),Object(n["createVNode"])(p,{text:"60'-1 quadrant","background-color":"orange","border-thickness":0,sectorAngleInDegree:60,initialQuadrant:1,diameter:280}),Object(n["createVNode"])(p,{text:"45'-2 quadrant","background-color":"blue","border-thickness":0,sectorAngleInDegree:45,initialQuadrant:2,diameter:280}),Object(n["createVNode"])(p,{text:"60'-2 quadrant","background-color":"orange","border-thickness":0,sectorAngleInDegree:60,initialQuadrant:2,diameter:280})])}const m=e=>(Object(n["pushScopeId"])("data-v-76140a74"),e=e(),Object(n["popScopeId"])(),e),f={class:"container relative",ref:"sectorContainer"},p={class:"sector",ref:"sector"},h=m(()=>Object(n["createElementVNode"])("div",{class:"sector__before"},null,-1)),j={class:"sector__content"},O=m(()=>Object(n["createElementVNode"])("div",{class:"sector__after"},null,-1));function y(e,t,r,o,a,c){return Object(n["openBlock"])(),Object(n["createElementBlock"])("section",null,[Object(n["createElementVNode"])("div",f,[Object(n["createElementVNode"])("div",p,[h,Object(n["createElementVNode"])("div",j,Object(n["toDisplayString"])(e.text),1),O],512)],512)])}var w=Object(n["defineComponent"])({name:"Sector",components:{},props:{diameter:{type:Number,default:200},unit:{type:String,default:"px"},backgroundColor:{type:String,default:"#000"},borderThickness:{type:Number,default:2},borderColor:{type:String,default:"#ab0"},sectorAngleInDegree:{type:Number,default:45},initialQuadrant:{type:Number,default:2},text:{type:String,default:"12340"},fontSize:{type:String,default:"10px"},fontColor:{type:String,default:"#fff"}},setup(e){const t=Object(n["ref"])(),r=Object(n["ref"])();return Object(n["onMounted"])(()=>{const n=e.unit,o=`${e.diameter/2}${n}`,a=`${e.diameter}${n}`,c=e.backgroundColor,i=e.borderColor,l=e.borderThickness,s=`${l}${n} ${l}${n} 0`,d=`${o} ${o} 0 0`,u=`${o} ${o}`,b=-90,g=e.fontSize,m=e.fontColor,f={marginLeft:o,width:o,height:a,borderRadius:`0 ${o} ${o} 0`,transform:`rotate(${90*(e.initialQuadrant-1)}deg)`,transformOrigin:"0px "+o},p={boxSizing:"border-box",width:a,height:o,backgroundColor:c,borderColor:i,borderWidth:s,borderRadius:d,transformOrigin:u},h={transform:`rotate(${b+e.sectorAngleInDegree}deg)`},j={transform:`rotate(${b+e.sectorAngleInDegree/2}deg)`,display:"flex",alignSelf:"flex-end",flexDirection:"row",justifyContent:"flex-end",alignItems:"flex-end",lineHeight:0,fontSize:g,color:m},O={transform:`rotate(${b+180}deg)`},y=t.value,w=t.value.querySelector(".sector__before"),v=t.value.querySelector(".sector__after"),_=t.value.querySelector(".sector__content");Object.assign(r.value.style,{width:a,height:a}),Object.assign(y.style,f),Object.assign(w.style,p),Object.assign(v.style,p),Object.assign(_.style,p),Object.assign(w.style,h),Object.assign(v.style,O),Object.assign(_.style,j)}),{sector:t,sectorContainer:r}}}),v=(r("eebe"),r("6b0d")),_=r.n(v);const k=_()(w,[["render",y],["__scopeId","data-v-76140a74"]]);var S=k;class N{async getRoulette(e){const t={create_datetime:"",end_datetime:"",start_datetime:"",update_datetime:"",name:"",reward_type:0,type:0},r=8;let n=-1;const o=new Array(r).fill(0).map(e=>{n++;let r=3==n;return{...t,firstPrize:r,id:n,worth:(100+1e3*n).toString()}}),a={data:o};return Promise.resolve(a)}async getRouletteRandom(e){const t={create_datetime:"",end_datetime:"",firstPrize:!1,id:0,name:"",reward_type:0,start_datetime:"",type:0,update_datetime:"",worth:""},r={data:t};return Promise.resolve(r)}async getRouletteRecord(){const e=[{create_datetime:"",record_id:0,username:"",worth:""}],t={data:e};return Promise.resolve(t)}}const x=new N;var C=x;const D=(e,t)=>Math.round(e+Math.random()*(t-e));var V;(function(e){e[e["idle"]=0]="idle",e[e["spinning"]=1]="spinning"})(V||(V={}));var E=Object(n["defineComponent"])({name:"SpinWheel",components:{Sector:S},setup(){const e={firstPrize:"#fff",0:"#fa638b",1:"#f9ea63",2:"#25b8d7",3:"#62faba"},t=Object(n["reactive"])({list:[],wheelList:[],prizesLength:0,initialDegree:90,targetDegree:0,stage:V.idle,counter:1,sectorAngle:0,luckyList:[]}),r=Object(n["ref"])(),o=Object(n["computed"])(()=>360/t.list.length),a=Object(n["computed"])(()=>Number(o.value.toFixed(2))),c=async()=>{if(t.stage==V.spinning)return;const e=D(0,t.list.length),r=t.list[e],n=r.worth.toString();i(n),setTimeout(async()=>{await d()},5e3)},i=e=>{let r=0;const n=10800*t.counter,a=t.list.findIndex(t=>t.worth==e),c=(t.list.findIndex(e=>(r+=o.value,Math.floor(r)>=t.initialDegree)),o.value*a-t.initialDegree),i=+o.value/2;t.targetDegree=-(n+c+i)};Object(n["watch"])(()=>t.targetDegree,()=>{t.stage=V.spinning,r.value.style.transform=`rotate(${t.targetDegree}deg)`});const l=async()=>{const e=await C.getRoulette({type:1});console.log("roulette",e),t.list=e.data,t.prizesLength=e.data.length,t.sectorAngle=360/t.prizesLength},s=e=>{let r=Number(e[0].worth);for(let t=0;t<e.length;t++)Number(e[t].worth)>r&&(r=Number(e[t].worth));e.map(e=>{Number(e.worth)==r&&(e.firstPrize=!0)}),t.wheelList=e},d=async()=>{await C.getRouletteRecord()};return Object(n["onMounted"])(async()=>{r.value.addEventListener("transitionstart",()=>{console.log("anim start")}),r.value.addEventListener("transitionend",()=>{console.log("animation has ended"),t.stage=V.idle,t.counter++}),await l(),await s(t.list),await d()}),{...Object(n["toRefs"])(t),radius:a,wheelElt:r,spin:c,EStage:V,getColor(t,r){return t.firstPrize?e.firstPrize:e[r%4]},getFontColor(e){return e.firstPrize?"#000":"#fff"},getSectorStyle(e){return`transform: rotate(${t.sectorAngle*e}deg)`}}}});r("b218");const I=_()(E,[["render",g],["__scopeId","data-v-61d498d5"]]);t["default"]=I}}]);